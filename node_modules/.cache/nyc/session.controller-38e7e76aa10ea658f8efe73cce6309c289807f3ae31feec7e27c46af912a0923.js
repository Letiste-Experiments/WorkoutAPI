function cov_24v3fyto2n(){var path="/home/leo/workout-api/api/controllers/session.controller.js";var hash="66c46ee78f06a18d1a3bb75797d700111e527f99";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/leo/workout-api/api/controllers/session.controller.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:36}},"1":{start:{line:2,column:11},end:{line:2,column:31}},"2":{start:{line:3,column:13},end:{line:3,column:21}},"3":{start:{line:4,column:22},end:{line:4,column:37}},"4":{start:{line:5,column:21},end:{line:5,column:69}},"5":{start:{line:6,column:19},end:{line:6,column:63}},"6":{start:{line:8,column:28},end:{line:8,column:36}},"7":{start:{line:10,column:0},end:{line:36,column:1}},"8":{start:{line:11,column:16},end:{line:11,column:30}},"9":{start:{line:12,column:19},end:{line:12,column:36}},"10":{start:{line:13,column:15},end:{line:13,column:58}},"11":{start:{line:14,column:2},end:{line:34,column:3}},"12":{start:{line:15,column:18},end:{line:15,column:69}},"13":{start:{line:17,column:4},end:{line:31,column:5}},"14":{start:{line:18,column:6},end:{line:18,column:34}},"15":{start:{line:20,column:6},end:{line:26,column:7}},"16":{start:{line:21,column:8},end:{line:21,column:34}},"17":{start:{line:22,column:8},end:{line:22,column:64}},"18":{start:{line:23,column:8},end:{line:23,column:25}},"19":{start:{line:24,column:8},end:{line:24,column:51}},"20":{start:{line:25,column:8},end:{line:25,column:55}},"21":{start:{line:27,column:6},end:{line:27,column:27}},"22":{start:{line:28,column:6},end:{line:28,column:38}},"23":{start:{line:30,column:6},end:{line:30,column:70}},"24":{start:{line:33,column:4},end:{line:33,column:68}},"25":{start:{line:38,column:0},end:{line:60,column:1}},"26":{start:{line:39,column:2},end:{line:59,column:3}},"27":{start:{line:40,column:19},end:{line:40,column:37}},"28":{start:{line:41,column:17},end:{line:41,column:44}},"29":{start:{line:42,column:28},end:{line:42,column:48}},"30":{start:{line:44,column:4},end:{line:56,column:5}},"31":{start:{line:45,column:21},end:{line:45,column:85}},"32":{start:{line:47,column:6},end:{line:52,column:7}},"33":{start:{line:48,column:8},end:{line:48,column:27}},"34":{start:{line:49,column:8},end:{line:49,column:35}},"35":{start:{line:51,column:8},end:{line:51,column:60}},"36":{start:{line:54,column:6},end:{line:54,column:25}},"37":{start:{line:55,column:6},end:{line:55,column:33}},"38":{start:{line:58,column:4},end:{line:58,column:56}},"39":{start:{line:62,column:0},end:{line:66,column:1}},"40":{start:{line:63,column:2},end:{line:63,column:27}},"41":{start:{line:64,column:2},end:{line:64,column:35}},"42":{start:{line:65,column:2},end:{line:65,column:57}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:17},end:{line:10,column:18}},loc:{start:{line:10,column:37},end:{line:36,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:38,column:14},end:{line:38,column:15}},loc:{start:{line:38,column:34},end:{line:60,column:1}},line:38},"2":{name:"(anonymous_2)",decl:{start:{line:62,column:17},end:{line:62,column:18}},loc:{start:{line:62,column:31},end:{line:66,column:1}},line:62}},branchMap:{"0":{loc:{start:{line:14,column:2},end:{line:34,column:3}},type:"if",locations:[{start:{line:14,column:2},end:{line:34,column:3}},{start:{line:14,column:2},end:{line:34,column:3}}],line:14},"1":{loc:{start:{line:17,column:4},end:{line:31,column:5}},type:"if",locations:[{start:{line:17,column:4},end:{line:31,column:5}},{start:{line:17,column:4},end:{line:31,column:5}}],line:17},"2":{loc:{start:{line:20,column:6},end:{line:26,column:7}},type:"if",locations:[{start:{line:20,column:6},end:{line:26,column:7}},{start:{line:20,column:6},end:{line:26,column:7}}],line:20},"3":{loc:{start:{line:39,column:2},end:{line:59,column:3}},type:"if",locations:[{start:{line:39,column:2},end:{line:59,column:3}},{start:{line:39,column:2},end:{line:59,column:3}}],line:39},"4":{loc:{start:{line:44,column:4},end:{line:56,column:5}},type:"if",locations:[{start:{line:44,column:4},end:{line:56,column:5}},{start:{line:44,column:4},end:{line:56,column:5}}],line:44},"5":{loc:{start:{line:47,column:6},end:{line:52,column:7}},type:"if",locations:[{start:{line:47,column:6},end:{line:52,column:7}},{start:{line:47,column:6},end:{line:52,column:7}}],line:47}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"66c46ee78f06a18d1a3bb75797d700111e527f99"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_24v3fyto2n=function(){return actualCoverage;};}return actualCoverage;}cov_24v3fyto2n();const argon2=(cov_24v3fyto2n().s[0]++,require("phc-argon2"));const db=(cov_24v3fyto2n().s[1]++,require("../models"));const User=(cov_24v3fyto2n().s[2]++,db.users);const{v4:genuuid}=(cov_24v3fyto2n().s[3]++,require('uuid'));const{Encryption}=(cov_24v3fyto2n().s[4]++,require("@adonisjs/encryption/build/standalone"));const encryption=(cov_24v3fyto2n().s[5]++,new Encryption({secret:"i2l7hVvohkBGqcct"}));const ONE_YEAR_IN_SECONDS=(cov_24v3fyto2n().s[6]++,31556952);cov_24v3fyto2n().s[7]++;exports.create=async(req,res)=>{cov_24v3fyto2n().f[0]++;const email=(cov_24v3fyto2n().s[8]++,req.body.email);const password=(cov_24v3fyto2n().s[9]++,req.body.password);const user=(cov_24v3fyto2n().s[10]++,await User.findOne({where:{email:email}}));cov_24v3fyto2n().s[11]++;if(user){cov_24v3fyto2n().b[0][0]++;const match=(cov_24v3fyto2n().s[12]++,await argon2.verify(user.password_digest,password));cov_24v3fyto2n().s[13]++;if(match){cov_24v3fyto2n().b[1][0]++;cov_24v3fyto2n().s[14]++;req.session.userid=user.id;cov_24v3fyto2n().s[15]++;if(req.body.rememberMe){cov_24v3fyto2n().b[2][0]++;cov_24v3fyto2n().s[16]++;remember_token=genuuid();cov_24v3fyto2n().s[17]++;user.remember_digest=await argon2.hash(remember_token);cov_24v3fyto2n().s[18]++;await user.save();cov_24v3fyto2n().s[19]++;req.session.remember_token=remember_token;cov_24v3fyto2n().s[20]++;req.session.cookie.maxAge=ONE_YEAR_IN_SECONDS;}else{cov_24v3fyto2n().b[2][1]++;}cov_24v3fyto2n().s[21]++;req.session.views=1;cov_24v3fyto2n().s[22]++;req.res.send({message:user.id});}else{cov_24v3fyto2n().b[1][1]++;cov_24v3fyto2n().s[23]++;res.status(500).send({message:"Invalid email and/or password"});}}else{cov_24v3fyto2n().b[0][1]++;cov_24v3fyto2n().s[24]++;res.status(500).send({message:"Invalid email and/or password"});}};cov_24v3fyto2n().s[25]++;exports.get=async(req,res)=>{cov_24v3fyto2n().f[1]++;cov_24v3fyto2n().s[26]++;if(req.session.userid){cov_24v3fyto2n().b[3][0]++;const userid=(cov_24v3fyto2n().s[27]++,req.session.userid);const user=(cov_24v3fyto2n().s[28]++,await User.findByPk(userid));const remember_digest=(cov_24v3fyto2n().s[29]++,user.remember_digest);cov_24v3fyto2n().s[30]++;if(req.session.remember_token){cov_24v3fyto2n().b[4][0]++;const result=(cov_24v3fyto2n().s[31]++,await argon2.verify(remember_digest,req.session.remember_token));cov_24v3fyto2n().s[32]++;if(result){cov_24v3fyto2n().b[5][0]++;cov_24v3fyto2n().s[33]++;req.session.views++;cov_24v3fyto2n().s[34]++;res.send({message:userid});}else{cov_24v3fyto2n().b[5][1]++;cov_24v3fyto2n().s[35]++;res.status(500).send({message:"No user logged in"});}}else{cov_24v3fyto2n().b[4][1]++;cov_24v3fyto2n().s[36]++;req.session.views++;cov_24v3fyto2n().s[37]++;res.send({message:userid});}}else{cov_24v3fyto2n().b[3][1]++;cov_24v3fyto2n().s[38]++;res.status(500).send({message:"No user logged in"});}};cov_24v3fyto2n().s[39]++;exports.delete=(req,res)=>{cov_24v3fyto2n().f[2]++;cov_24v3fyto2n().s[40]++;req.session.userid=null;cov_24v3fyto2n().s[41]++;req.session.remember_token=null;cov_24v3fyto2n().s[42]++;res.send({message:"Session was deleted successfully"});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlc3Npb24uY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhcmdvbjIiLCJyZXF1aXJlIiwiZGIiLCJVc2VyIiwidXNlcnMiLCJ2NCIsImdlbnV1aWQiLCJFbmNyeXB0aW9uIiwiZW5jcnlwdGlvbiIsInNlY3JldCIsIk9ORV9ZRUFSX0lOX1NFQ09ORFMiLCJleHBvcnRzIiwiY3JlYXRlIiwicmVxIiwicmVzIiwiZW1haWwiLCJib2R5IiwicGFzc3dvcmQiLCJ1c2VyIiwiZmluZE9uZSIsIndoZXJlIiwibWF0Y2giLCJ2ZXJpZnkiLCJwYXNzd29yZF9kaWdlc3QiLCJzZXNzaW9uIiwidXNlcmlkIiwiaWQiLCJyZW1lbWJlck1lIiwicmVtZW1iZXJfdG9rZW4iLCJyZW1lbWJlcl9kaWdlc3QiLCJoYXNoIiwic2F2ZSIsImNvb2tpZSIsIm1heEFnZSIsInZpZXdzIiwic2VuZCIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJnZXQiLCJmaW5kQnlQayIsInJlc3VsdCIsImRlbGV0ZSJdLCJtYXBwaW5ncyI6Im8xSkFlWTsyRkFmWixLQUFNQSxDQUFBQSxNQUFNLDBCQUFHQyxPQUFPLENBQUMsWUFBRCxDQUFWLENBQVosQ0FDQSxLQUFNQyxDQUFBQSxFQUFFLDBCQUFHRCxPQUFPLENBQUMsV0FBRCxDQUFWLENBQVIsQ0FDQSxLQUFNRSxDQUFBQSxJQUFJLDBCQUFHRCxFQUFFLENBQUNFLEtBQU4sQ0FBVixDQUNBLEtBQU0sQ0FBQ0MsRUFBRSxDQUFFQyxPQUFMLDJCQUFnQkwsT0FBTyxDQUFDLE1BQUQsQ0FBdkIsQ0FBTixDQUNBLEtBQU0sQ0FBQ00sVUFBRCwyQkFBZU4sT0FBTyxDQUFDLHVDQUFELENBQXRCLENBQU4sQ0FDQSxLQUFNTyxDQUFBQSxVQUFVLDBCQUFHLEdBQUlELENBQUFBLFVBQUosQ0FBZSxDQUFDRSxNQUFNLENBQUUsa0JBQVQsQ0FBZixDQUFILENBQWhCLENBRUEsS0FBTUMsQ0FBQUEsbUJBQW1CLDBCQUFHLFFBQUgsQ0FBekIsQyx3QkFFQUMsT0FB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Q0FBVCxFQUNELENBSEQsSUFHTyxxREFDTFgsR0FBRyxDQUFDdUIsTUFBSixDQUFXLEdBQVgsRUFBZ0JGLElBQWhCLENBQXFCLENBQUNDLE9BQU8sQ0FBRSxtQkFBVixDQUFyQixFQUNELENBQ0YsQ0FURCxJQVNPLHFEQUNMdkIsR0FBRyxDQUFDVyxPQUFKLENBQVlVLEtBQVosR0FESyx5QkFFTHBCLEdBQUcsQ0FBQ3FCLElBQUosQ0FBUyxDQUFDQyxPQUFPLENBQUVYLE1BQVYsQ0FBVCxFQUNELENBQ0YsQ0FsQkQsSUFrQk8scURBQ0xYLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBVyxHQUFYLEVBQWdCRixJQUFoQixDQUFxQixDQUFDQyxPQUFPLENBQUUsbUJBQVYsQ0FBckIsRUFDRCxDQUNGLENBdEJELEMseUJBd0JBekIsT0FBTyxDQUFDOEIsTUFBUixDQUFpQixDQUFDNUIsR0FBRCxDQUFNQyxHQUFOLEdBQWMsa0RBQzdCRCxHQUFHLENBQUNXLE9BQUosQ0FBWUMsTUFBWixDQUFxQixJQUFyQixDQUQ2Qix5QkFFN0JaLEdBQUcsQ0FBQ1csT0FBSixDQUFZSSxjQUFaLENBQTZCLElBQTdCLENBRjZCLHlCQUc3QmQsR0FBRyxDQUFDcUIsSUFBSixDQUFTLENBQUNDLE9BQU8sQ0FBRSxrQ0FBVixDQUFULEVBQ0QsQ0FKRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGFyZ29uMiA9IHJlcXVpcmUoXCJwaGMtYXJnb24yXCIpXG5jb25zdCBkYiA9IHJlcXVpcmUoXCIuLi9tb2RlbHNcIilcbmNvbnN0IFVzZXIgPSBkYi51c2Vyc1xuY29uc3Qge3Y0OiBnZW51dWlkfSA9IHJlcXVpcmUoJ3V1aWQnKVxuY29uc3Qge0VuY3J5cHRpb259ID0gcmVxdWlyZShcIkBhZG9uaXNqcy9lbmNyeXB0aW9uL2J1aWxkL3N0YW5kYWxvbmVcIilcbmNvbnN0IGVuY3J5cHRpb24gPSBuZXcgRW5jcnlwdGlvbih7c2VjcmV0OiBcImkybDdoVnZvaGtCR3FjY3RcIn0pXG5cbmNvbnN0IE9ORV9ZRUFSX0lOX1NFQ09ORFMgPSAzMTU1Njk1MlxuXG5leHBvcnRzLmNyZWF0ZSA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBlbWFpbCA9IHJlcS5ib2R5LmVtYWlsXG4gIGNvbnN0IHBhc3N3b3JkID0gcmVxLmJvZHkucGFzc3dvcmRcbiAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7d2hlcmU6IHtlbWFpbDogZW1haWx9fSlcbiAgaWYgKHVzZXIpIHtcbiAgICBjb25zdCBtYXRjaCA9IGF3YWl0IGFyZ29uMi52ZXJpZnkodXNlci5wYXNzd29yZF9kaWdlc3QsIHBhc3N3b3JkKVxuXG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICByZXEuc2Vzc2lvbi51c2VyaWQgPSB1c2VyLmlkXG5cbiAgICAgIGlmIChyZXEuYm9keS5yZW1lbWJlck1lKSB7XG4gICAgICAgIHJlbWVtYmVyX3Rva2VuID0gZ2VudXVpZCgpXG4gICAgICAgIHVzZXIucmVtZW1iZXJfZGlnZXN0ID0gYXdhaXQgYXJnb24yLmhhc2gocmVtZW1iZXJfdG9rZW4pXG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgIHJlcS5zZXNzaW9uLnJlbWVtYmVyX3Rva2VuID0gcmVtZW1iZXJfdG9rZW5cbiAgICAgICAgcmVxLnNlc3Npb24uY29va2llLm1heEFnZSA9IE9ORV9ZRUFSX0lOX1NFQ09ORFNcbiAgICAgIH1cbiAgICAgIHJlcS5zZXNzaW9uLnZpZXdzID0gMVxuICAgICAgcmVxLnJlcy5zZW5kKHttZXNzYWdlOiB1c2VyLmlkfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoe21lc3NhZ2U6IFwiSW52YWxpZCBlbWFpbCBhbmQvb3IgcGFzc3dvcmRcIn0pXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHttZXNzYWdlOiBcIkludmFsaWQgZW1haWwgYW5kL29yIHBhc3N3b3JkXCJ9KVxuICB9XG5cbn1cblxuZXhwb3J0cy5nZXQgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgaWYgKHJlcS5zZXNzaW9uLnVzZXJpZCkge1xuICAgIGNvbnN0IHVzZXJpZCA9IHJlcS5zZXNzaW9uLnVzZXJpZFxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeVBrKHVzZXJpZClcbiAgICBjb25zdCByZW1lbWJlcl9kaWdlc3QgPSB1c2VyLnJlbWVtYmVyX2RpZ2VzdFxuXG4gICAgaWYgKHJlcS5zZXNzaW9uLnJlbWVtYmVyX3Rva2VuKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcmdvbjIudmVyaWZ5KHJlbWVtYmVyX2RpZ2VzdCwgcmVxLnNlc3Npb24ucmVtZW1iZXJfdG9rZW4pXG5cbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgcmVxLnNlc3Npb24udmlld3MrK1xuICAgICAgICByZXMuc2VuZCh7bWVzc2FnZTogdXNlcmlkfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHttZXNzYWdlOiBcIk5vIHVzZXIgbG9nZ2VkIGluXCJ9KVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXEuc2Vzc2lvbi52aWV3cysrXG4gICAgICByZXMuc2VuZCh7bWVzc2FnZTogdXNlcmlkfSlcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoe21lc3NhZ2U6IFwiTm8gdXNlciBsb2dnZWQgaW5cIn0pXG4gIH1cbn1cblxuZXhwb3J0cy5kZWxldGUgPSAocmVxLCByZXMpID0+IHtcbiAgcmVxLnNlc3Npb24udXNlcmlkID0gbnVsbFxuICByZXEuc2Vzc2lvbi5yZW1lbWJlcl90b2tlbiA9IG51bGxcbiAgcmVzLnNlbmQoe21lc3NhZ2U6IFwiU2Vzc2lvbiB3YXMgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIn0pXG59XG4iXX0=